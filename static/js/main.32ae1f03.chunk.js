(this["webpackJsonplocation-based-train-times"]=this["webpackJsonplocation-based-train-times"]||[]).push([[0],{15:function(t,e,n){},16:function(t,e,n){},17:function(t,e,n){"use strict";n.r(e);var o=n(0),c=n(1),a=n.n(c),r=n(9),s=n.n(r),i=(n(15),n(2)),g=n(7),u=n(3),l=n(4),C=n(6),I=n(5),d=function(t){Object(C.a)(n,t);var e=Object(I.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return void 0===this.props.postcode||this.props.postcode.length<=0?null:Object(o.jsxs)("div",{className:"postcode-wrapper",children:["Your postcode is ",this.props.postcode]})}}]),n}(c.Component),p=function(t){Object(C.a)(n,t);var e=Object(I.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var t=this;return Object(o.jsxs)("div",{className:"search-wrapper",children:[Object(o.jsxs)("form",{onSubmit:function(t){t.preventDefault()},children:[Object(o.jsx)("input",{type:"text",name:"searchQuery",placeholder:"Enter a postcode or town",onChange:function(e){t.props.searchQueryHandler(e)}}),Object(o.jsx)("button",{style:this.props.locationSearching?{backgroundImage:"url(data:image/svg+xml;base64,PCEtLSBCeSBTYW0gSGVyYmVydCAoQHNoZXJiKSwgZm9yIGV2ZXJ5b25lLiBNb3JlIEAgaHR0cDovL2dvby5nbC83QUp6YkwgLS0+Cjxzdmcgd2lkdGg9IjM4IiBoZWlnaHQ9IjM4IiB2aWV3Qm94PSIwIDAgMzggMzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMSAxKSIgc3Ryb2tlLXdpZHRoPSIyIj4KICAgICAgICAgICAgPGNpcmNsZSBzdHJva2Utb3BhY2l0eT0iLjUiIGN4PSIxOCIgY3k9IjE4IiByPSIxOCIvPgogICAgICAgICAgICA8cGF0aCBkPSJNMzYgMThjMC05Ljk0LTguMDYtMTgtMTgtMTgiPgogICAgICAgICAgICAgICAgPGFuaW1hdGVUcmFuc2Zvcm0KICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iCiAgICAgICAgICAgICAgICAgICAgdHlwZT0icm90YXRlIgogICAgICAgICAgICAgICAgICAgIGZyb209IjAgMTggMTgiCiAgICAgICAgICAgICAgICAgICAgdG89IjM2MCAxOCAxOCIKICAgICAgICAgICAgICAgICAgICBkdXI9IjFzIgogICAgICAgICAgICAgICAgICAgIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+CiAgICAgICAgICAgIDwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==)"}:{},type:"button",onClick:function(e){t.props.geolocationClickHandler(e)}}),Object(o.jsx)("button",{type:"submit",onClick:function(e){t.props.buttonClickHandler(e)}})]}),Object(o.jsx)(d,{postcode:this.props.userPostcode})]})}}]),n}(c.Component),b=(n(16),function(t){Object(C.a)(n,t);var e=Object(I.a)(n);function n(){var t;return Object(u.a)(this,n),(t=e.call(this)).searchQueryHandler=function(e){t.setState(Object(g.a)({},e.target.name,e.target.value))},t.buttonClickHandler=function(e){e.preventDefault(),t.getClosestPostcode(t.state.searchQuery)},t.success=function(e){var n=e.coords,o=n.name,c=n.latitude,a=n.longitude;t.setState((function(t){return Object(i.a)(Object(i.a)({},t),{},{userLatitude:c,userLongitude:a,userPostcode:o,locationSearching:!1})}),(function(){var e=t.state,n=e.userLatitude,o=e.userLongitude;t.getClosestStations(n,o)}))},t.error=function(e){console.log("geolocation error:"),console.log(e),t.setState({locationSearching:!1})},t.geolocationClickHandler=function(){"geolocation"in navigator?(navigator.geolocation.getCurrentPosition(t.success,t.error,{timeout:1e5,enableHighAccuracy:!0,maximumAge:6e4}),t.setState({locationSearching:!0})):console.log("sorry, looks as though you browser doesn't support geolocation!")},t.getClosestPostcode=function(e){console.log("searching for a postcode!");var n="https://transportapi.com/v3/uk/places.json?app_id=c15b5dbb&app_key=1cfe30d14a3934983892bed20b27e431&query=".concat(e,"&type=postcode");fetch(n).then((function(t){return t.json()})).then((function(e){var n=e.member[0],o=n.name,c=n.latitude,a=n.longitude;t.setState((function(t){return Object(i.a)(Object(i.a)({},t),{},{userLatitude:c,userLongitude:a,userPostcode:o})}),(function(){var e=t.state,n=e.userLatitude,o=e.userLongitude;t.getClosestStations(n,o)}))}))},t.getClosestStations=function(e,n){var o="https://transportapi.com/v3/uk/places.json?app_id=c15b5dbb&app_key=1cfe30d14a3934983892bed20b27e431&lat=".concat(e,"&lon=").concat(n,"&type=postcode,train_station");fetch(o).then((function(t){return t.json()})).then((function(e){var n,o,c=(n=e.member,o="type",n.reduce((function(t,e){return t[e[o]]||(t[e[o]]=[]),t[e[o]].push(e),t}),{}));console.log(c),t.setState((function(t){return Object(i.a)(Object(i.a)({},t),{},{userPostcode:c.postcode[0].name})}))}))},t.state={searchQuery:null,userLatitude:null,userLongitude:null,userPostcode:null,closestStations:null,locationSearching:!1},t}return Object(l.a)(n,[{key:"render",value:function(){var t=this;return Object(o.jsx)(o.Fragment,{children:Object(o.jsx)(p,{searchQueryHandler:function(e){t.searchQueryHandler(e)},buttonClickHandler:function(e){t.buttonClickHandler(e)},geolocationClickHandler:function(e){t.geolocationClickHandler(e)},userPostcode:null!==this.state.userPostcode?this.state.userPostcode:"",locationSearching:this.state.locationSearching})})}}]),n}(c.Component)),A=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(e){var n=e.getCLS,o=e.getFID,c=e.getFCP,a=e.getLCP,r=e.getTTFB;n(t),o(t),c(t),a(t),r(t)}))};s.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(b,{})}),document.getElementById("root")),A()}},[[17,1,2]]]);
//# sourceMappingURL=main.32ae1f03.chunk.js.map