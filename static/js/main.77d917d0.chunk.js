(this["webpackJsonplocation-based-train-times"]=this["webpackJsonplocation-based-train-times"]||[]).push([[0],{14:function(t,e,n){},15:function(t,e,n){},16:function(t,e,n){"use strict";n.r(e);var o=n(0),i=n(1),a=n.n(i),s=n(8),c=n.n(s),r=(n(14),n(2)),u=n(3),l=n(4),d=n(6),p=n(5),h=function(t){Object(d.a)(n,t);var e=Object(p.a)(n);function n(){return Object(u.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(o.jsx)("div",{children:"By using your location provided by the browser, it looks like you are in the ".concat(this.props.postcode," postcode. Your nearest train stations are:")})}}]),n}(i.Component),b=function(t){Object(d.a)(n,t);var e=Object(p.a)(n);function n(){return Object(u.a)(this,n),e.call(this)}return Object(l.a)(n,[{key:"render",value:function(){return this.props.selectedStationName===this.props.name?Object(o.jsx)("li",{style:{fontWeight:"bold"},children:this.props.departureTime+" - "+this.props.name}):Object(o.jsx)("li",{children:this.props.departureTime+" - "+this.props.name})}}]),n}(i.Component),j=function(t){Object(d.a)(n,t);var e=Object(p.a)(n);function n(){var t;return Object(u.a)(this,n),(t=e.call(this)).state={servicesLoaded:!1,serviceInfo:[]},t}return Object(l.a)(n,[{key:"serviceClickHandler",value:function(t,e){var n=this;t.stopPropagation(),fetch(e).then((function(t){return t.json()})).then((function(t){n.setState((function(e){return Object(r.a)(Object(r.a)({},e),{},{servicesLoaded:!e.servicesLoaded,serviceInfo:t})}),(function(){console.log(n.state.serviceInfo)}))}))}},{key:"render",value:function(){var t,e=this;return console.log(this.state.serviceInfo),0!==this.state.serviceInfo.length&&(t=this.state.serviceInfo.stops.map((function(t){return Object(o.jsx)(b,{name:t.station_name,selectedStationName:e.props.selectedStationName,selectedStationCode:e.props.selectedStationCode,departureTime:t.aimed_departure_time},t.station_code)}))),Object(o.jsxs)("li",{onClick:function(t){e.serviceClickHandler(t,e.props.serviceUrl)},children:["".concat(this.props.departTime," to ").concat(this.props.destination),Object(o.jsx)("ul",{children:t})]})}}]),n}(i.Component),f=function(t){Object(d.a)(n,t);var e=Object(p.a)(n);function n(){var t;return Object(u.a)(this,n),(t=e.call(this)).state={selectedStationName:null,selectedStationCode:null,timetableLoaded:!1,timetable:[]},t}return Object(l.a)(n,[{key:"stationClickHandler",value:function(t,e){var n=this;t.stopPropagation(),fetch("https://transportapi.com/v3/uk/train/station/".concat(e,"///live.json?app_id=c15b5dbb&app_key=1cfe30d14a3934983892bed20b27e431&train_status=passenger")).then((function(t){return t.json()})).then((function(t){console.log(t),n.setState((function(e){return Object(r.a)(Object(r.a)({},e),{},{timetableLoaded:!e.timetableLoaded,timetable:t.departures.all,selectedStationName:t.station_name,selectedStationCode:t.station_code})}),(function(){console.log(n.state)}))}))}},{key:"render",value:function(){var t,e=this,n=this.state,i=n.timetable,a=n.timetableLoaded,s=n.selectedStationName,c=n.selectedStationCode,r=this.props,u=r.code,l=r.name;return!i.length<1&&a?t=i.map((function(t){return Object(o.jsx)(j,{selectedStationName:s,selectedStationCode:c,departTime:t.aimed_departure_time,destination:t.destination_name,serviceUrl:t.service_timetable.id},t.train_uid)})):a&&(t="Sorry, it looks like there are no services available from this station."),Object(o.jsxs)("li",{onClick:function(t){e.stationClickHandler(t,u)},children:[Object(o.jsx)(o.Fragment,{children:l}),Object(o.jsx)("ul",{children:t})]})}}]),n}(i.Component),m=(n(15),function(t){Object(d.a)(n,t);var e=Object(p.a)(n);function n(){var t;return Object(u.a)(this,n),(t=e.call(this)).success=function(e){t.setState((function(t){return Object(r.a)(Object(r.a)({},t),{},{latitude:e.coords.latitude,longitude:e.coords.longitude})}),(function(){var e=t.state,n=e.latitude,o=e.longitude;t.getNearestStations(n,o)}))},t.state={latitude:null,longitude:null,postcodes:[],stationList:[]},t}return Object(l.a)(n,[{key:"getCurrentLocation",value:function(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(this.success,this.error)}},{key:"groupBy",value:function(t,e){return t.reduce((function(t,n){return t[n[e]]||(t[n[e]]=[]),t[n[e]].push(n),t}),{})}},{key:"getNearestStations",value:function(t,e){var n=this;fetch("https://transportapi.com/v3/uk/places.json?app_id=c15b5dbb&app_key=1cfe30d14a3934983892bed20b27e431&lat=".concat(t,"&lon=").concat(e,"&type=train_station,postcode")).then((function(t){return t.json()})).then((function(t){var e=n.groupBy(t.member,"type");n.setState((function(t){return Object(r.a)(Object(r.a)({},t),{},{postcodes:e.postcode,stationList:e.train_station})}),(function(){console.log(n.state)}))}))}},{key:"render",value:function(){var t,e,n=this;return!this.state.stationList.length<1&&(t=this.state.stationList.map((function(t){return Object(o.jsx)(f,{name:t.name,code:t.station_code},t.station_code)}))),!this.state.postcodes.length<1&&(e=this.state.postcodes[0].name),Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{children:Object(o.jsx)("button",{onClick:function(){n.getCurrentLocation()},children:"Where am I?"})}),Object(o.jsx)("div",{children:this.state.postcodes.length>0?Object(o.jsx)(h,{postcode:e}):""}),Object(o.jsx)("ul",{children:t})]})}}]),n}(i.Component)),v=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(e){var n=e.getCLS,o=e.getFID,i=e.getFCP,a=e.getLCP,s=e.getTTFB;n(t),o(t),i(t),a(t),s(t)}))};c.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(m,{})}),document.getElementById("root")),v()}},[[16,1,2]]]);
//# sourceMappingURL=main.77d917d0.chunk.js.map